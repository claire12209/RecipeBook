<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Recipe Details</title>
</head>
<body>
    <h1 th:text="${recipe.name}">Recipe Name</h1>

    <p>Added by: 
        <span th:text="${recipe.user != null ? recipe.user.username : 'Unknown'}">Username</span>
    </p>

    <h2>Ingredients</h2>
    <ol>
        <th:block th:each="ingredient : ${recipe.ingredients}">
            <li th:text="${ingredient}">Ingredient</li>
        </th:block>
    </ol>

    <h2>Steps</h2>
    <ol>
        <th:block th:each="step : ${recipe.steps}">
            <li th:text="${step}">Step</li>
        </th:block>
    </ol>

    <h3>Average Rating: <span th:text="${recipe.averageRating}">0</span></h3>

    <form th:action="@{/recipe/{id}/rate(id=${recipe.id})}" method="post">
        <label for="rating">Rate this recipe:</label>
        <input type="number" id="rating" name="rating" min="1" max="5" required/>
        <button type="submit">Submit Rating</button>
    </form>

    <!-- Reviews Section -->
    <h3>Reviews</h3>

    <!-- Check if there are any reviews -->
    <div th:if="${#lists.isEmpty(reviews)}">
        <p>No reviews yet. Be the first to review!</p>
    </div>

    <!-- Display reviews -->
    <ul th:if="${!#lists.isEmpty(reviews)}" th:each="review : ${reviews}">
        <li>
            <p><strong>User:</strong> <span th:text="${review.user != null ? review.user.username : 'Anonymous'}"></span></p>
            <p><strong>Rating:</strong> <span th:text="${review.rating}"></span> / 5</p>
            <p><strong>Date:</strong> <span th:text="${#dates.format(review.date, 'yyyy-MM-dd HH:mm')}"></span></p>
            <p><strong>Comment:</strong> <span th:text="${review.comment}"></span></p>
        </li>
    </ul>

    <a href="/home">Back to Home</a>
</body>
</html>
